\documentclass[a4paper, 12pt]{book}

\usepackage{fancyhdr}

\newcommand{\ttitle}{Numerične metode za linearne sisteme upravljanja - zapiski s predavanj prof. Plestenjaka}
\newcommand{\tauthor}{Tomaž Poljanšek}
\newcommand{\tdate}{študijsko leto 2023/24}

\usepackage{color}
\usepackage{soul}
\usepackage[numbers]{natbib}

\usepackage{physics}

\usepackage[parfill]{parskip}
\usepackage[hyphens]{url}

\usepackage[usestackEOL]{stackengine}[2013-10-15] % formatting Pascal
\usepackage[dvipsnames]{xcolor}

\usepackage{cancel}
\usepackage[export]{adjustbox}

% Related to math
\usepackage{amsmath,amssymb,amsfonts,amsthm}
\usepackage{mathtools}
\usepackage{youngtab}
\usepackage{tikz}
\usepackage{yhmath}

% encoding and language
\usepackage{lmodern}
\usepackage[slovene, english]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

% multiline comments
\usepackage{comment}
\usepackage{verbatim}

% random text - for texting
\usepackage{lipsum}
\usepackage{blindtext}

\usepackage{hyperref}

\usepackage{listings}
\usepackage{verbatim}
\usepackage{fancyvrb}

% images
\usepackage{graphicx}
\graphicspath{ {../images/} }

% no blank page
\usepackage{atbegshi}
\renewcommand{\cleardoublepage}{\clearpage}

% theorems
\theoremstyle{definition}
\newtheorem{counter}{Counter}[section]
\newtheorem{defn}[counter]{Definicija}
\newtheorem{lemma}[counter]{Lema}
\newtheorem{conseq}[counter]{Posledica}
\newtheorem{claim}[counter]{Trditev}
\newtheorem{theorem}[counter]{Izrek}
\newtheorem{pro}[counter]{Dokaz}
%%
\theoremstyle{remark}
\newtheorem*{ex}{Primer}
\newtheorem*{exmp}{Zgled}
\newtheorem*{rem}{Opomba}

% QED
\renewcommand\qedsymbol{$\blacksquare$}

\hypersetup{pdftitle={\ttitle}}

\addtolength{\marginparwidth}{-20pt}
\addtolength{\oddsidemargin}{40pt}
\addtolength{\evensidemargin}{-40pt}

\renewcommand{\baselinestretch}{1.3}
\setlength{\headheight}{15pt}
\renewcommand{\chaptermark}[1]
{\markboth{\MakeUppercase{\thechapter.\ #1}}{}} \renewcommand{\sectionmark}[1]
{\markright{\MakeUppercase{\thesection.\ #1}}} \renewcommand{\headrulewidth}{0.5pt} \renewcommand{\footrulewidth}{0pt}

% header
\fancyhf{}
\fancyhead[LE,RO]{\sl \thepage} 
\fancyhead[RE]{\sc \tauthor}
\fancyhead[LO]{\sc Numerične metode za linearne sisteme upravljanja}


\newcommand{\autfont}{\Large}
\newcommand{\titfont}{\LARGE\bf}
\newcommand{\clearemptydoublepage}{\newpage{\pagestyle{empty}\cleardoublepage}}
\setcounter{tocdepth}{1}

\usepackage{bbold}

\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\Po}{\mathbb{P}}
\newcommand{\One}{\mathbb{1}}

\newcommand{\ch}{\operatorname{char}}
\newcommand*\Eval[3]{\left.#1\right\rvert_{#2}^{#3}}
\newcommand*\circled[1]{\tikz[baseline=(char.base)]{%
            \node[shape=circle,fill=white!20,draw,inner sep=2pt] (char) {#1};}}

\makeatletter
\newcommand{\longeq}[1]{\mathrel{\mathpalette\longeq@{#1}}}
\newcommand{\longeq@}[2]{%
  \begingroup
  \sbox\z@{$\m@th#1=$}%
  \ifdim#2<\wd\z@
    \resizebox{#2}{\height}{\box\z@}%
  \else
    \ifdim#2<3\wd\z@
      \hbox to #2{$\m@th#1=\hss=\hss=\hss=$}%
    \else
      \hbox to #2{$\m@th#1=\cleaders\hbox to 0.2\wd\z@{\hss$#1=$\hss}\hfil=$}%
    \fi
  \fi
  \endgroup
}
\makeatother

\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}

\usepackage{float}
\usepackage{multirow}
\usepackage{icomma}
\usepackage{tabularx}
\usepackage{hhline}

\usepackage{enumitem}
\usepackage{ulem}
\newcommand{\msout}[1]{\text{\sout{\ensuremath{#1}}}} % cross text in math mode

\title{\ttitle}
\author{\tauthor}
\date{\tdate}

\newcommand\mymaketitle{
  \begin{titlepage}
    \begin{center}
        \vspace*{4cm}
        \Huge
        \textbf{\ttitle}
                        
        \vspace{1.5cm}
        \huge
        \tauthor
            
        \vspace{3cm}
        \Large
        \tdate
    \end{center}
  \end{titlepage}
}




\begin{document}

\selectlanguage{slovene}
%\setcounter{page}{1}
\renewcommand{\thepage}{}
\newcommand{\sn}[1]{"`#1"'}

\mymaketitle

\clearpage

\frontmatter

% kazalo
%\pagestyle{empty}
%\def\thepage{}
%\tableofcontents{}

%%
%\def\x{\hspace{3ex}}    %BETWEEN TWO 1-DIGIT NUMBERS
%\def\y{\hspace{2.45ex}}  %BETWEEN 1 AND 2 DIGIT NUMBERS
%\def\z{\hspace{1.9ex}}    %BETWEEN TWO 2-DIGIT NUMBERS
%\stackMath

%\clearpage
%\phantomsection

%\section*{Seznam uporabljenih kratic}

%\noindent\begin{tabular}{p{0.1\textwidth}|p{.8\textwidth}}
%  {\bf kratica} & pomen \\ \hline
%  {\bf SVM}   & support vector machine (metoda podpornih vektorjev) \\
%\end{tabular}

%\clearpage
%\phantomsection
%\addcontentsline{toc}{chapter}{Povzetek}
%\chapter*{Povzetek}

%Predloga.


\mainmatter
\setcounter{page}{1}
\pagestyle{fancy}

\pagenumbering{arabic}



% 1. predavanje 20.2.

\chapter{Klasična teorija}


\section{Sistemi upravljanja}

Imamo dinamični sistem, sestavljen iz več komponent. \\
% skica
Stanje sistema opisujejo notranje spremenljivke, nanj vplivamo (upravljamo, vodimo) z vhodom $u(t)$,
opazujemo pa lahko izhod $y(t)$. \\
Vhodno-izhodna oblika. \\
$t:$ čas, \\
$u(t) \in \R^m$, \\
$y(t) \in \R^r$, \\
$x(t) \in \R^n$, \\
$n >> m, r$. \\
Upravljanje običajno poteka preko krmilnika (regulatorja). \\
% skica
Sisteme ločimo na
\begin{enumerate}[label=\alph*)]
  \item odprtozančne in
  \item zaprtozančne.
\end{enumerate}
Pri odprtozančnih sistemih krnilnik ni povezan z izhodom (stanjem) sistema. \\
Npr.
\begin{enumerate}[label=-]
  \item ročna klimatska naprava,
  \item stari parni stroji,
  \item glasbene skrinjice,
  \item svetilnik.
\end{enumerate}
Pri zaprtozančnih sistemih imamo še povratno zvezo s stanjem ali izhodom sistema. \\
% skica
Zgledi:
\begin{itemize}[label=-]
  \item avtomatska klimatska naprava,
  \item tempomat,
  \item avtopilot,
  \item kotliček za izplakovanje,
  \item Wattov regulator parnega stroja.
\end{itemize}
% skica
Manj pretoka $\implies$ počasneje, več pretoka $\implies$ hitreje.


\section{Lastnosti sistemov}

Splošni dinamični sistem lahko predstavimo s pomočno preslikave iz vhodnih funkcij v izhodne funkcije. \\
Vpeljimo naslednje oznake: \\
$T$: časovni prostor, urejena podmnožica $\R$, \\
$U$: vhodni prostor, množica vseh možnih stanj vhoda, $\subset \R^m$, \\
$\Omega \subset \{u: T \to U\}$: prostor vseh možnih vhodnih funkcij, \\
$X$: prostor stanj, množica vseh možnih stanj sistema, $\subset \R^n$. \\
Če ima sistem izhod, imamo še \\
$Y$: izhodni prostor, množica vseh možnih stanj izhoda, $\subset \R^r$, \\
$\Gamma \subset \{y: T \to Y\}$: prostor vseh izhodnih funkcij. \\
$\Omega$ mora biti neprazen in za $t_1 < t_2 < t_3$ iz $T$ in poljubni $u_1, u_2 \in \Omega$ mora obstajati $u_3 \in \Omega$:
\begin{equation*}
  u_3(t) = \begin{cases*}
    u_1(t), & za $t_1 \leq t \leq t_2$ \\
    u_2(t), & za $t_2 \leq t \leq t_3$
  \end{cases*}
\end{equation*}
Naš sistem opisuje preslikavo stanja \\
$\phi: T \times T \times X \times \Omega \to X$, kjer je \\
$\phi(t_1, t_0, x_0, u)$ stanje sistema $x(t_1)$ v času $t_1 \in T$, ki nastane iz začetnega stanja $x_0 \in X$
v času $t_0 \in T$ pod vplivom vhodne funkcije $u \in \Omega$. \\
$\phi$ mora biti dobro definirana za $t_1 \geq t_0$, ne pa tudi za $t_1 < t_0$. \\
Za $\phi$ mora veljati:
\begin{enumerate}[label=\alph*)]
  \item lastnost identitete: $\phi(t_0, t_0, x_0, u) = x_0 \;$ $\forall t_0 \in T, \forall x_0 \in x, \forall u \in \Omega$,
  \item lastnost podgrupe: $t_0 \leq t_1 \leq t_2 \in T: \;$ $\phi(t_2, t_0, x_0, u)
    = \phi(t_2, t_1, \phi(t_1, t_0, x_0, u), u)$.
\end{enumerate}
% skica
Če ima sistem izhod, obstaja še preslikava \\
$\psi: T \times X \times U \to Y$, da je \\
$y(t) = \psi(t, x(t), u(t))$ stanje izhoda v času $t$. \\
$\to$ izhod je odvisen samo od trenutnega stanja sistema in vhoda v času $t$ in časa $t$.
\begin{defn}
  Sistem je vzorčen, če je za poljuben $t_1 \in T$ velja: \\
  Če za $u_1, u_2 \in \Omega$ velja $u_1(t) = u_2(t)$ za $\forall t \leq t_1$, potem je \\
  $\phi(t_1, t_0, x_0, u_1) = \phi(t_1, t_0, x_0, u_2)$ za $\forall t_0 \leq t_1 \in T, \forall x_0 \in X$.
\end{defn}
Vzročnost pomeni, da je stanje sistema odvisno samo od prejšnjih ali sedanjih vrednosti vhoda.
\begin{defn}
    Naj bosta $\Omega$ in $X$ vektorska prostora.
    Sistem je linearen, če je za $\forall t_0 \leq t_1 \in T$ funkcija $\phi(t_1, t_0, ., .)$ linearna.
\end{defn}
$\phi(t_1, t_0, \alpha_1 x_1 + \alpha_2 x_2, \alpha_1 u_1 + \alpha_2 u_2)
= \alpha_1 \phi(t_1, t_0, x_1, u_1) + \alpha_2 \phi(t_1, t_0, x_2, u_2)$ \\
$\alpha_1 \begin{bmatrix} x_1 \\ u_1 \end{bmatrix} + \alpha_2 \begin{bmatrix} x_2 \\ u_2 \end{bmatrix}
= \begin{bmatrix} \alpha_1 x_1 + \alpha_2 x_2 \\ \alpha_1 x_1 + \alpha_2 u_2 \end{bmatrix}$ \\
za $\forall x_1, x_2 \in X, \forall u_1, u_2 \in \Omega$, skalarja $\alpha_1, \alpha_2$. \\
Če ima sistem izhod, mora biti $y$ vektorski prostor in $\psi(t, ., .)$ linearna za $\forall t \in T$. \\
Če je sistem linearen, iz
\begin{equation*}
    \begin{bmatrix} x_0 \\ u \end{bmatrix} = 1 \cdot \begin{bmatrix} x_0 \\ 0 \end{bmatrix}
    + 1 \cdot \begin{bmatrix} 0 \\ u \end{bmatrix}
\end{equation*}
dobimo
\begin{equation*}
    \phi(t_1, t_0, x_0, u) = \phi(t_1, t_0, x_0, 0) + \phi(t_1, t_0, 0, u);
\end{equation*}
$\phi(t_1, t_0, x_0, 0)$: odziv na ničelni vhod (zero input response), \\
$\phi(t_1, t_0, 0, u)$: odziv z ničelnim stanjem (zero state response). \\
% skica
\begin{lemma}
    Če je sistem linearen, je vzorčnost ekvivalentna pravilu začetnega mirovanje (p.z.m.).
\end{lemma}
Če za $u \in \Omega$ velja $u(t) = 0 \; \forall t \leq t_1$, potem je $\phi(t_1, t_0, 0, u) = 0 \; \forall t_0 \leq t_1$.
\begin{pro} \text{} \\
    $(\Rightarrow):$ \\
        Denimo, da sistem ne zadošča p.z.m. \\
        Torej $\exists \tilde{u} \in \Omega$, $\tilde{u} = 0$ za $t \leq t_1$
        in za nek $t_0 \leq t_1$ je $\phi(t_1, t_0 0, \tilde{u}) \neq 0$. \\
        Potem za poljubne $u$ in $x_0$ velja \\
        $\phi(t_1, t_0, x_0, u + \tilde{u}) \neq \phi(t_1, t_0, x_0, u)$,
        toda $u + \tilde{u}$ in $u$ se ujemata na $t \leq t_1$. \\
        $\implies$ sistem ni vzročen. \\
    $(\Leftarrow)$: \\
        Če sistem ni vzročen, $\exists u_1$ in $u_2$, ki se ujemata na $t \leq t_1$ in \\
        $\phi(t_1, t_0, x_0, u_1) \neq \phi(t_1, t_0, x_0, u_2)$. \\
        $\implies$ če vzamemo $\tilde{u} = u_1 - u_2$, je $\tilde{u} = 0$ na $t \leq t_1$ in $\phi(t_1, t_0, 0, \tilde{u}) \neq 0$.
\end{pro}
\begin{lemma}
    Če je sistem linearen, je $\phi(t_1, t_0, 0, 0) = 0$.
\end{lemma}
\begin{pro}
    $\phi(t_1, t_0, \alpha x_0, \alpha u) = \alpha \phi(t_1, t_0, x_0, u)$, vstavimo $\alpha = 0$.
\end{pro}
% skica
Za $\sigma \in T$ definiramo operator premika: $u \to u^{\sigma}$, kjer je $u^{\sigma}(t) = u(t - \sigma)$. \\
Velja naj, da je $T$ aditivna grupa in $\Omega$ zaprta za operator premika za \\
$\forall \sigma \in T$.
\begin{defn}
    Pravimo, da je sistem časovno nespremenljiv (time invariant), če za
    $\forall t_0 \leq t_1 \in T, \forall x_0 \in X, \forall u \in \Omega, \forall \sigma \in T$:
    \begin{equation*}
        x(t_1) := \phi(t_1, t_0, x_0, u) = \phi(t_1 + \sigma, t_0 + \sigma, x_0, u^{\sigma}) =: x^{\sigma}(t_1).
    \end{equation*}
\end{defn}
Če ima izhod, mora biti $\phi$ neodvisna od $t$.
\begin{exmp} \text{} \\
    \begin{center}
        \begin{tabular}{c | c c c}
             & vzorčen & linearen & časovno invarianten \\
            \hline
            $x(t) = u^2(t-1)$ & ja & ne & ja \\
            $x(t) = u(-t)$ & ne & ja & ne \\
            $x(t) = 3^{-t} u(t-1)$ & ja & ja & ne
        \end{tabular}
    \end{center}
\end{exmp}
Mi se bomo ukvarjali z vzorčnimi LTI (linearen + časovno invarianten) sistemi.
Ukvarjali se bomo z naslednjimi oblikami vzorčnih LTI sistemov.
\begin{enumerate}[label=\alph*]
    \item Zvezni sistemi: $T = \R$.
    \begin{enumerate}[label=a\arabic*)]
        \item Klasična vhodno-izhodna oblika. \\
            $y^{(n)}(t) + k_1 y^{(n-1)}(t) + \dots + k_n y(t) = \beta_0 u^{(m)}(t) + \dots + \beta_m u(t)$ \\
            začetni pogoji pri $t_0$.
        \item Predstavitev v prostoru stanj. \\
            $x^{.}(t) = A x(t) + B u(t); \quad x(t_0) = x_0, t \geq t_0$ \\
            $x^{.}(t) \in \R^n$: vektor stanja sistema, \\
            $u(t) \in \R^m$: vektor izhoda, \\
            $y(t) \in \R^r$: izhod, \\
            $m, r << n$. \\
            % skica
            $A: n \times n$ matrika stanje, \\
            $B: n \times m$: vhodna matrika, \\
            $C: r \times n$: izhodna matrika, \\
            $D: r \times m$: matrika diskretnega prehoda.
    \end{enumerate}
    \item Diskretni sistemi: $T = \{\delta t \cdot k, k \in \Z\}$; \\
        $\delta t$: interval vzorčenja. \\
        $u_k = u(k \cdot \delta t)$: iz diferencialnih enačb dobimo diferenčne enačbe
        \begin{enumerate}[label=b\arabic*)]
            \item $y_{j+n} + k_1 y_{j+n-1} + \dots + k_n y_j = \beta_0 u_{j+m} + \dots +  \beta_m u_j$,
                $j = 0, 1 \dots$ \\
                + začetne vrednosti.
            \item $x_{k+1} = A x_k + B u_k$ \\
                $y_k = C x_k + D u_k$.
        \end{enumerate}
\end{enumerate}
\begin{exmp} \text{} \\
    $x^{'}(t) = a x(t) + u(t)$, \\
    $x(t_0) = x_0, a \in \R$ \\
    $\implies x(t) = e^{a(t-t_0)} + \int_{t_0}^t e^{a(t-s)} u(s) ds = \phi(t, t_0, x_0, u)$. \\
    Preverimo lahko
    \begin{enumerate}[label=\alph*)]
        \item lastnost identitete: $\phi(t_0, t_0, x_0, u) = x_0 + 0 = x_0$,
        \item lastnost polgrupe:
            \begin{align*}
                &\phi(t_2, t_1, \phi(t_1, t_0, x_0, u), u) \\
                &= e^{a(t_2-t_1)} \cdot e^{a(t_1-t_0)} x_0
                + \int_{t_0}^{t_1} e^{a(t_1-s)} u(s) ds + \int_{t_1}^{t_2} e^{a(t_2-s)} u(s) ds \\
                &= \phi(t_2, t_0, x_0, u).
            \end{align*}
    \end{enumerate}
    Podobno preverimo linearnost:
    \begin{align*}
        &\phi(t_1, t_0, \alpha_1 x_1 + \alpha_2 x_2, \alpha_1 u_1 + \alpha_2 u_2) \\
        &= e^{a(t_1-t_0)}(\alpha_1 x_1 + \alpha_2 x_2) + \int_{t_0}^{t_1} e^{a(t_1-s)} (\alpha_1 u_1(s) + \alpha_2 u_2(s)) ds \\
        &= \alpha_1 \phi(t_1, t_0, x_1, u_1) + \alpha_2 \phi(t_1, t_0, x_2, u_2).
    \end{align*}
    Vzročnost = p.z.m. (pogoj začetnega mirovanja) \\
    $\phi(t_0, t_0, 0, 0) = 0$. \\
    Časovna nespremenljivost
    \begin{align*}
        &\phi(t_1 + \sigma, t_2 + \sigma, x_0, u^{\sigma}) \\
        &= e^{a(t_1+\sigma-(t_0+\sigma))} x_0 + \int_{t_0+\sigma}^{t_1+\sigma} e^{a(t_1+\sigma-s)} u(s-\sigma) ds.
    \end{align*}
    Substitucija $\tilde{s} = s - u$.
\end{exmp}



% 2. predavanje: 27.2.

\section{Laplaceova transformacija}

\begin{defn}
    Naj bo $f: [0, \infty) \to \R$.
    Laplaceova transformacija preslika $f$ v $F = \L(f)$, ki je definirana za $s \in \C$ z
    \begin{equation*}
        F(s) = \int_0^{\infty} f(t) e^{-st} dt
    \end{equation*}
    za vse tiste $s$, kjer integral obstaja.
\end{defn}
Pišemo: $\L(f(t))(s) = F(s)$ oz. $F = \L(f)$. \\
$t$: običajno čas, \\
$f$ original, $\L(f)$ Laplaceova transformiranka. \\
$\L$ preslika funkcijo iz časovnega prostora spremenljivke $t$ v funkcijo $F$
v frekvenčnem prostoru spremenljivke $s$.
\begin{theorem}
    Če je $f: [0, \infty) \to \R$ odsekoma zvezna in je \\
    $\int_0^{\infty} |f(t)| e^{-\sigma_0 t} dt < \infty$,
    potem Laplaceova transformacija $f$ obstaja za vse $s$, kjer je $Re(s) \geq \sigma_0$.
\end{theorem}
\begin{pro}
    Naj bo $Re(s) \geq \sigma_0$. Potem je
    \begin{align*}
        |f(s)| &= \left| \int_0^{\infty} f(t) e^{-st} dt \right| \\
        &\leq  \int_0^{\infty} |f(t)| \left| e^{-st} \right| dt \\
        &\leq  \int_0^{\infty} |f(t)| \left| e^{-\sigma_0 t} \right| dt \\
        &< \infty.
    \end{align*}
\end{pro}
Konvergenčna abscisa: tak $\alpha \in \R$ (če obstaja), da $\L(f)$ obstaja za vsak $s$ z
$Re(s) \geq \alpha$ in ne obstaja za $Re(s) < \alpha$. \\
Laplaceova transformacija odvoda:
\begin{align*}
    \L\left(f^{'}(t)\right)(s) &= \int_{0}^{\infty} f^{'}(t) e^{-st} dt \\
    &\stackrel{\text{per partes}}{\longeq{30px}} f(t) e^{-st} \vline_{0}^{\infty} +
    s \int_0^{\infty} f(t) e^{-st} dt \\
    &= -f(0_-) + s f(s).
\end{align*}
Tukaj predpostavimo, da je $f$ eksponentnega tipa, kar pomeni, da je \\
$|f(t)| \leq M \cdot e^{ct}$ za konstanti $M, c \in \R$. \\
$\L\left(f^{'}(t)\right)(s) = s \L(f(t))(s) - f(0_-)$. \\
Za naše potrebe potrebujemo malce spremenjeno Laplaceovo transformacijo $\L$, kjer je
\begin{equation*}
    \L(f(t))(s) = \int_{0_-}^{\infty} f(t) e^{-st} dt =
    \lim_{\varepsilon \to 0} \int_{0-\varepsilon}^{\infty} f(t) e^{-st} dt.
\end{equation*}
To potrebujemo zaradi posebnih funkcij, ena izmed njih je t.j. enotski impult $\delta(t)$,
definiran z $\delta(t) = 0$ za $\forall t \neq 0$ in $\int_{-\infty}^{\infty} \delta(t) dt = 1$. \\
$\delta$: Diracova delta funkcija. \\
$\delta(t)$ si lahko predstavljamo kot limito ustreznih funkcij, npr.
\begin{enumerate}[label=\alph*)]
    \item $\delta_{\varepsilon}(t) = \begin{cases}
        \frac{1}{2 \varepsilon} & \text{ za } -\varepsilon \leq t \leq \varepsilon \\
        0 & \text{ sicer}
        \end{cases}$ - odsekoma zvezna,
    \item $\delta_{\varepsilon}(t) = \frac{1}{\varepsilon \sqrt{\pi}} e^{-\frac{t^2}{\varepsilon}}$ -
      neskončnokrat zvezno odvedljiva.
\end{enumerate}
Za $\L(\delta)$ potem dobimo
\begin{align*}
    \L(\delta(t))(s) &= \lim_{\varepsilon \to 0} \int_{0 - \varepsilon}^{\infty} \delta_{\varepsilon}(t) e^{-st} dt \\
    &= \lim_{\varepsilon \to 0} \int_{-\varepsilon}^{\varepsilon} \frac{1}{2 \varepsilon} e^{-st} dt \\
    &= \lim_{\varepsilon \to 0} \frac{1}{2 \varepsilon s} \left(e^{\varepsilon s} - e^{-\varepsilon s}\right) \\
    &= \left(e^{s}\right)^{'}(0) = 1.
\end{align*}
$\L(\delta(t))(s) = 0$ za $\forall t \neq 0$. \\
Druga posebna funkcija je enotska stopnica - $u_s(t) = \begin{cases}
    1: \; &t \geq 0 \\
    0: \; &t < 0
\end{cases}$, $s$: \sn{step}. \\
$\L(u_s(t))(s) = \int_0^{\infty} e^{-st} = \frac{1}{s}$. \\
V dinamičnih sistemih lahko pišemo, da je $\delta(t) = u_s^{'}(t)$.
Argumenti so
\begin{enumerate}[label=\alph*)]
    \item $u_s^{'}(t) = 0$ za $\forall t \neq 0$,
    \item $1 = \L(\delta(t))(s) = s \cdot \L(u_s(t))(s) - u_s(0_-) = s \cdot \frac{1}{s} - 0 = 1$ \checkmark
\end{enumerate}
Podobno velja za višje odvode \\
$\L\left(\delta^{(k)}(t)\right)(s) = s^k$ (a) ni najbolj ustrezna). \\
Funkcija $f$ je lahko oblike $f(t) = f_r(t) + f_{sing}(t)$; \\
$f_r(t)$ je regularni del, to je kosoma zvezno odvedljiva funkcija,
kjer je točk nezveznosti na vsakem končnem intervalu končno mnogo, v vseh točkah obstajajo
$\lim_{t \to t_u^-} f^{(j)}(t)$ in $\lim_{t \to t_u^+} f^{(j)}(t)$, \\
$f_{sing}(t)$ je oblike $\sum_{k=1}^{\infty} \sum_{j_k=0}^{n_k} \alpha_{jk} \delta{j_k} (t-t_k)$. \\
Glavne lastnosti:
\begin{enumerate}
    \item linearnost: $\L(\alpha_1 f_1(t) + \alpha_2 f_2(t))(s) = \alpha_1 F_1(s) + \alpha_2 F_2(s)$,
        to velja za $s \in \C$, kjer sta definirani hkrati $F_1$ in $F_2$,
    \item transformiranka odvoda:
        \begin{align*}
            &\L(f^{'}(t))(s) = s F(s) - f^{'}(0_-) \\
            &\L(f^{''}(t))(s) = s \L(f^{'}(t))(s) - f^{'}(0_-) = s^2 F(s) - s f(0_-) - f^{'}(0_-) \\
            &\L(f^{(n)}(t))(s) = s^n F(s) - s^{n-1} f^{'}(0_-) + \dots + f^{(n-1)}(0_-),
        \end{align*}
    \item transformiranka integrala: $\L\left(\int_0^{\infty} f(\tau) d\tau\right) = \frac{F(s)}{s}$,
    \item časovni premik: $\L(f(t-t_0) u_s(t-t_0))(s) = e^{-t_0 s} F(s)$; \\
        $u_s(t-t_0)$: na ta način odrežemo vse vrednosti pred $t_0$,
    \item frekvenčni premik: $\L(f(t) e^{\alpha t})(s) = F(s-\alpha)$,
    \item izrek o začetni vrednosti: $\lim_{s \to \infty} F(s) = f(0_+)$,
    \item izrek o končni vrednosti: $\lim_{s \to 0} s F(s) = \lim_{t \to \infty} f(t)$; \\
        to velja, če je $s F(s)$ analitična na $\{s: Re(s) \geq 0\} \iff F$
        nima polov s pozitivnim realnim delom, pri $s=0$ pa ima največ pol stopnje 1,
    \item inverzna transformacija: $f(t) = \L^{-1}(F(s))(t) =
        \frac{1}{2 \pi i} \int_{\sigma - i \infty}^{\sigma + i \infty} F(s) e^{-st} ds$,
        kjer je $\sigma$ večji od vseh realnih delov $F$,
    \item če je $f_1(t) = f_2(t) = 0$ za $t < 0$, potem je konvolucija $f_1$ in $f_2$ definirana z
        \begin{equation*}
            (f_1 * f_2)(t) = \int_0^t f_1(\tau) f_2(t-\tau) d\tau = \int_0^t f_2(\tau) f_1(t-\tau) d\tau.
        \end{equation*}
        Velja: $\L((f_1 * f_2)(t))(s) = F_1(s) F_2(s)$; \\
        Laplaceova transformacija konvolucije funkcij je produkt Laplaceovih transformirank. \\
        V drugo smer: $\L(f_1(t) f_2(t))(s) = \frac{1}{2 \pi i} \int_{\sigma - i \infty}^{\sigma + i \infty}
        F_1(\rho) F_2(s - \rho) d\rho$; \\
        Laplaceova transformacija produkta je konvolucija Laplaceovih transformirank.
\end{enumerate}
\begin{exmp} za konvolucijo. \\
    $f_1(t) = \begin{cases}
        1 - \frac{t}{4}; & 0 \leq t \leq 4 \\
        0; & \text{sicer}
    \end{cases}$ \\
    % skica
    $f_2(t) = \begin{cases}
        \frac{3}{2} - \frac{t}{2}; & 1 \leq t \leq 3 \\
        0; & \text{sicer}
    \end{cases}$ \\
    % skica
    $(f_1 * f_2)(t) = \int_0^t f_1(\tau) f_2(t-\tau) d\tau$ \\
    $\implies (f_1 * f_2)(t) = \begin{cases}
        0; & t \leq 1 \text{ ali } t \geq 7 \\
        g_1(t); & 1 \leq t \leq 3 \\
        g_2(t); & 3 \leq t \leq 5 \\
        g_3(t); & 5 \leq t \leq 7
    \end{cases}$
    % skica
\end{exmp}
Nekaj osnovnih transformacij
\begin{center}
   \begin{tabular}{c | c}
        $f(t)$ & $F(s)$ \\
        \hline
        $\delta(t)$ & 1 \\
        $u_s(t)$ & $\frac{1}{s}$ \\
        $e^{-at} u_s(t)$ & $\frac{1}{s + a}$ \\
        $\cos(at)$ & $\frac{s}{s^2 + a^2}$ \\
        $\sin(at)$ & $\frac{a}{s^2 + a^2}$
   \end{tabular}
\end{center}

\begin{center}
   \begin{tabular}{c | c}
        $f(t)$ & $F(s)$ \\
        \hline
        $\delta^k(t)$ & $s^k$ \\
        $t^k u_s(t)$ & $\frac{k!}{s^{k+1}}$ \\
        $\frac{t^k}{k!} e^{-at}$ & $\frac{1}{(s+a)^{k+1}}$ \\
        $\cosh(at)$ & $\frac{s}{s^2 - a^2}$ \\
        $\sinh(at)$ & $\frac{a}{s^2 - a^2}$
   \end{tabular}
\end{center}


\section{Prenosna funkcija}

% skica
Klasična vhodno-izhodna oblika LTI sistema je podana z \\
$y^{(n)}(t) + k_1 y^{(n-1)}(t) + \dots + k_n y(t) = \beta_0 u^{(m)}(t) + \dots + \beta_m u(t)$ \\
+ začetni pogoji. \\
Pravimo, da je sistem relaksiran, če je: \\
$y^{(j)}(0_-) = 0$ za $j = 0, 1 \dots n-1$, \\
$u^{(l)}(o_-) = 0$ za $l = 0, 1 \dots m$. \\
Naj bo $\tilde{y}(s) = \L(y(t))(s), \tilde{u}(s) = \L(u(t))(s)$.
Tako dobimo
\begin{equation*}
    \left(s^n + k_1 s^{n-1} + \dots + k_n\right) \tilde{y}(s) =
    \left(\beta_0 s^m + \dots + \beta_m\right) \tilde{u}(s);
\end{equation*}
$k(s) := s^n + k_1 s^{n-1} + \dots + k_n$ in \\
$\beta(s) := \beta_0 s^m + \dots + \beta_m$ sta karakteristična polinoma. \\
$\L\left(y{(n)}(t)\right)(s) = s^k \tilde{y}(s) - \dots$ \\
Ostalo $= 0$, ker je sistem relaksiran. \\
$\tilde{y}(s) = \frac{\beta(s)}{k(s)} \tilde{u}(s) = g(s) \tilde{u}(s)$; \\
$g(s)$: prenosna funkcija. \\
Poli $g$ so ničle $k$, označimo jih s $p_1 \dots p_n$, \\
ničle $g$ so ničle $\beta$, označimo jih z $z_1 \dots z_m$ \\
$\implies$ dobimo t.i. zpk (ničle-poli-ojačanje) obliko \\
$g(s) = \beta_0 \frac{(s-z_1) \dots (s-z_m)}{(s-p_1) \dots (s-p_n)}$. \\
Posebni primeri izhodov (odzivov) so:
\begin{enumerate}[label=\alph*)]
    \item če je vhod enotski impulz $\delta(t)$, dobimo impulzni odziv $h(t)$,
    \item če je vhod enotska stopnica $u_s(t)$, dobimo stopnični odziv $y_s(t)$.
\end{enumerate}
% skica
$\L(\delta(t))(s) = 1 \implies \L(h(t))(s) = g(s) \implies$
Laplaceova transformiranka impulznega odziva je prenosna funkcija. \\
$h(t) = \L^{-1}(g(s))(t)$. \\
Podobno iz $\L(u_s(t))(s) = \frac{1}{s}$ sledi $y_s(t) =
\L^{-1}\left(\frac{g(s)}{s}\right)(t)$ \\
% skica
$\implies$ izhod je konvolucija impulznega odziva in vhoda $y(t) = (g * u)(t)$.
\begin{theorem}
    Odziv na poljuben vhod $u(t)$ je konvolucija impulznega odziva in vhoda
    $y(t) = (h * u)(t) = \int_0^t u(\tau) h(t-\tau) d\tau$.
\end{theorem}
\begin{exmp} \text{} \\
    Imamo relaksiran sistem $y^{''}(t) + 3 y{'}(t) + 2 y(t) = 4 u^{'}(t) + u(t)$ \\
    $\implies g(s) = \frac{4s+1}{s^2+3s+2}$. \\
    Z razvojem v parcialne ulomke lahko dobimo impulzni in stolpični odziv.
    \begin{enumerate}[label=\alph*)]
        \item Impulzni odziv \\
            $h(t) = \L^{-1}(g(s))(t)$ \\
            $g(s) = \frac{A_1}{s+1} + \frac{A_2}{s+2} = \frac{-3}{s+1} + \frac{7}{s+2}$ \\
            $A_1 = g(s) (s+1) \vert_{s=-1} = \frac{4s+1}{s+2} \vert_{s=-1} = -3$ \\
            $A_2 = g(s) (s+2) \vert_{s=-2} = \frac{4s+1}{s+1} \vert_{s=-2} = 7$ \\
            $\implies h(t) = \left( -3e^{-t} + 7e^{-2t}\right) u_s(t)$; \\
            $u_s(t)$, ker je odziv vedno za $t \geq 0$.
            % skica
        \item Stopnični odziv \\
            $y_s(t) = \L^{-1}\left(\frac{g(s)}{s}\right)(t)$ \\
            $\frac{g(s)}{s} = \frac{\frac{1}{2}}{s} + \frac{s}{s+2} - \frac{\frac{3}{2}}{s+2}$ \\
            $\implies y_s(t) = \left(\frac{1}{2} + 3 e^{-t} - \frac{3}{2} e^{-2t}\right) u_s(t)$; \\
            $\frac{1}{2}$: stacionarni odziv, \\
            $3e^{-t} - \frac{3}{2} e^{-2t}$: prehodni odziv. \\
            % skica
            $\lim_{s \to \infty} s F(s) = \lim_{t \to \infty} f(t)$, \\
            $y_s^{'}(t) = h(t)$.
    \end{enumerate}
\end{exmp}



% 3. predavanje 5.3.

% skica
\begin{equation}
  \label{eq:sistem}
  y^{(n)}(t) + k_1 y^{(n-1)}(t) + \dots + k_n y(t) = \beta_0 u^{(m)}(t) + \dots + \beta_m u(t)
\end{equation}
$\L(u(t))(s) = \int_{0_-}^{\infty} f(t) e^{-ts} dt =: \tilde{u}(s), \\
\tilde{y}(s) := \L(y(t))(s)$ \\
$\tilde{y}(s) = g(s) \tilde{u}(s)$ \\
$g(s) = \frac{\beta_0 s^m + \dots + \beta_m}{s^n + k_1 s^{n-1} + \dots + k_n}$ prenosna funkcija, \\
$\delta(t)$: enotski impulz $\implies h(t)$ impulzni odziv, \\
$u_s(t)$: enotska stopnica $\implies y_s(t)$ stopični odziv \\
$\L(\delta(t))(s) \equiv 1 \implies \L(h(t))(s) = g(s)$ \\
$\L(u_s(t))(s) = \frac{1}{s}$ \\
$y(t) = (u * h)(t) = \int_0^t u(\tau) h(t-\tau) d\tau$ \\
$\delta(t) = u_s^{'}(t)$, na enem primeru smo videli $h(t) = y_s^{'}(t)$.
\begin{theorem}
  Če je $h(t)$ impulzni odziv relaksiranega LTI sistema in $y_s(t)$ njegov stopični odziv,
  potem je $h(t) = y_s^{'}(t)$.
\end{theorem}
\begin{pro} \text{} \\
  \begin{enumerate}[label=\alph*)]
      \item Če uporabimo zvezo s konvolucijo, dobimo
          \begin{align*}
              y_s(t) &= (u_s * h)(t) \\
              &= \int_0^t u(\tau) h(t-\tau) d\tau \\
              &= \int_0^t h(\tau) u(t-\tau) d\tau \\
              &= \int_0^t h(t) d\tau
          \end{align*}
          $\implies y_s^{'}(t) = h(t)$ (oz. tudi z Laplacem).
      \item Velja še bolj splošno: če je $y(t)$ izhod za $u(t)$,
          potem je $y^{'}(t)$ izhod za $u^{'}(t)$. \\
          \refeq{eq:sistem} lahko zapišemo v obliki \\
          $A y = B u$, \\
          kjer sta $A$ in $B$ diferencialna operatorja: \\
          $A = \frac{d^n}{dt^n} + k_1 \frac{d^{n-1}}{dt^{n-1}} + \dots + k_n I_d$, \\
          $B = \beta_0 \frac{d^m}{dt^m} + \dots + \beta_m I_d$. \\
          Ker $A, B$ komutirata z $\frac{d}{dt} \implies
          \frac{d}{dt} A y = \frac{d}{dt} B u$ \\
          $A \left(\frac{d}{dt} y\right) = B \left(\frac{d}{dt} u \right)$.
  \end{enumerate}
\end{pro}


\section{Stabilnost}

Če imamo sistem z enim vhodom in enim izhodom, je to SISO (single input-single output) sistem.
% skica
\begin{defn}
  SISO sistem je BIBO (bounded input-bounded output) stabilen,
  če je sistem tak, da je za vsak omejen vhod tudi izhod omejen. \\
  Če $\exists c_1$, da je $|u(t)| < c_1$ za $\forall t \geq 0$, potem $\exists c_2$,
  da je $|y(t)| \leq c_2$ za $\forall t \geq 0$.
\end{defn}
\begin{theorem}
  SISO sistem je BIBO stabilen $\iff$ impulzni sistem je absolutno integrabilen:
  $\int_0^{\infty} |h(t)| dt < \infty$.
\end{theorem}
\begin{pro} \text{} \\
  $(\Leftarrow)$: \\
  Naj bo $|u(t)| < c_1$,
  \begin{align*}
      &y(t) = \int_0^t h(\tau) u(t-\tau) d\tau \\
      \implies &|y(t)| \leq c_1 \int_0^t |h(\tau)| d\tau
      \leq c_1 \int_0^{\infty} |h(\tau)| d\tau =: c_2 < \infty.
  \end{align*}
  $(\Rightarrow)$: \\
  Denimo, da $h(t)$ ni absolutno integrabilen, torej za $\forall M > 0 \; \exists T > 0$,
  da je $\int_0^T |h(\tau)| d\tau \geq M$. \\
  Če za isti $T$ vzamemo za vhod \\
  $u(t) = sign(h(\tau-t))$, je \\
  $y(T) = \int_0^T u(\tau) h(t-\tau) d\tau = \int_0^T |h(t-\tau)| d\tau \geq M$ \\
  $\implies$ sistem ni BIBO stabilen.
\end{pro}
V primeru standardne vhodno-izhodne oblike, kjer ima premosna funkcija obliko racionalne funkcije,
je stabilnost odvisna od polov sistema.
\begin{enumerate}[label=\alph*)]
  \item Za vse pole $p_1 \dots p_n$ velja $Re(p_i) < 0 \implies$ sistem je BIBO stabilen \\
      $\{z \in \C: Re(z) < 0\}$.
  \item Za vse pole velja $Re(p_i) \leq 0$ in vsi poli, kjer je $Re(p_i) = 0$ so enostavni. \\
      Iz enostavnosti polov $p_1 \dots p_n$ dobimo \\
      $h(t) = \sum_{i=1}^n \alpha_i e^{p_i t}$. \\
      V primeru polov $p_1 \dots p_r$ z večkratnostmi $m_1 \dots m_r, \sum_{j=1}^r m_j = n$
      dobimo $h(t) = \sum_{i=1}^r \alpha_i e^{p_i t}$,
      kjer je $\alpha_i$ polinom stopnje $m_i-1$ \\
      $\implies$ sistem je šibko stabilen, ni BIBO stabilen, je za $h(t)$ omejen.
  \item Če obstaja pol z $Re(p_i) > 0$ ali večkraten pol z $Re(p_i) = 0$
      $\implies$ sistem ni stabilen.
\end{enumerate}
\begin{exmp} \text{} \\
  Splošni sistem 1. reda je \\
  $y^{'}(t) + k_1 y(t) = \beta_0 u(t) \implies g(s) = \frac{\beta_0}{s+k_1}$ \\
  $\implies h(t) = \beta_0 e^{-k_1 t} [u_s(t)]$. \\
  Za stabilnost potrebujemo: $k_1 > 0$ za BIBO stabilnost in $k_1 = 0$ za šibko stabilnost. \\
  % skica
  Stopnični odziv: $y_s(t) = \frac{\beta_0}{k_1} \left(1 - e^{-k_1 t}\right)$. \\
  % skica
  Splošni sistem 2. reda: \\
  $y^{''}(t) + k_1 y^{'}(t) + k_2 y(t) = \beta_0 u(t); k_1, k_2 \geq 0$. \\
  Tak sistem ustreza npr. situaciji [z vzmetjo]. \\
  % skica
  $m y^{..}(t) + b y^{.}(t) + k y(t) = f(t)$; \\
  $b$: koeficient dušenja, \\
  $k$: koeficient vzmeti. \\
  Dušenje je proporcionalno hitrosti $(y^{.}(t))$, \\
  sila vzmeti je proporcionalna raztezku $(y(t))$. \\
  Poli: $s^2 + k_1 s + k_2 = 0 \implies s_{1,2} =
  \frac{-k_1 \pm \sqrt{k_1^2 - 4k_1}}{2}$.
  \begin{enumerate}[label=\alph*)]
      \item $k_1^2 > 4k_2$: 2 realna pola, oba sta negativna \\
          $\implies$ nekritično dušenje.
      \item $k_1^2 < 4k_2$: kompleksen par polov $p = \sigma \pm i \omega$ \\
          $\sigma = -\frac{k_1}{2}, \omega = \frac{\sqrt{4k_2 - k_1^2}}{2}$ \\
          $\implies$ podkritično dušenje.
      \item $k_1^2 = 4k_2 \implies p_{1,2} = -\frac{k_1}{2}$ \\
          $\implies$ kritično dušenje.
  \end{enumerate}
  Impulzni odzivi so
  \begin{enumerate}[label=\alph*)]
      \item $\frac{\beta_0}{p_1-p_2} \left(e^{p_1 t} - e^{p_2 t}\right)$
      \item $\frac{\beta_0}{\omega_0} e^{\sigma t} \sim (\omega_0 t)$
      \item $\frac{\beta_0}{k_2} p^2 + e^{pt}$.
  \end{enumerate}
  Npr. $k_1 = \frac{1}{2}, 1, \frac{3}{2}, 2, 3, 4, k_2 = 1$: \\
  $\frac{1}{2}, 1, \frac{3}{2} \to b), 2 \to a), 3, 4 \to c)$.
\end{exmp}


\section{Bodejev diagram}

Imamo relaksiran sistem v vhodno-izhodni obliki: \\
$\tilde{y}(s) = g(s) \tilde{u}{s}$, \\
$g(s) = \frac{\beta_0 s^m + \dots + \beta_m}{s^n + k_1 s^{n-1} + \dots + k_n}$. \\
Zanima nas odziv na vhod oblike $u(t) = e^{\alpha t} [u_s(t)]$. \\
Predpostavimo, da $\alpha$ ni pol \\
$\L(u(t))(s) = \frac{1}{s-\alpha} \implies y(t) =
\L^{-1}\left(\frac{1}{s-\alpha} g(s)\right)(t)$ \\
$\implies$ v razvoju na parcialne ulomke dobimo poleg členov s poli $g$ še $\frac{A}{s-\alpha}$. \\
Ker $\alpha$ ni pol prenosne funkcije $\implies$ \\
$A = \lim_{s \to \infty} \left(\frac{1}{s-\alpha} \cdot g(s) (s-\alpha)\right) = g(\alpha)$ \\
$\implies y(t)$ vsebuje člen $g(\alpha) e^{\alpha t}$. \\
$\cos(\omega t) = \frac{1}{2} \left(e^{i \omega t} + e^{-i \omega t}\right)$ \\
$\implies$ če je $u(t) = \cos(\omega t), y(t)$ vsebuje \\
$\frac{1}{2} g(i \omega) e^{i \omega t} + \frac{1}{2} g(-i \omega) e^{-i \omega t}$; \\
$g(i \omega) = |g(i \omega)| e^{i \phi}$, \\
$g(-i \omega) = \overline{g(i \omega)}$ \\
$\implies y(t)$ vsebuje
\begin{equation*}
  \frac{1}{2} |g(i \omega)| \left(e^{i \phi} \cdot e^{i \omega t} +
  e^{-i \phi} \cdot e^{-i \omega t}\right) = |g(i \omega)| cos(\omega t + \phi).
\end{equation*}
$|g(i \omega)|$: ojačanje ali amplitudni odziv, \\
$\phi = arg(g(i \omega))$: fazni premik. \\
Ojačanje merimo v decibelih: $|g(i \omega)|_{db} = 20 \log_{10} (|g(i \omega)|)$. \\
Fazni premik merimo v stopinjah od $-180^{\circ}$ do $180^{\circ}$. \\
Bodejev diagram je graf amplitudnega in faznega odziva. \\
$g(i \omega)$: frekvenčna funkcija.
\begin{exmp} \text{} \\
  $Z_f \left([3 \; 2], [1 \; 1+2\alpha \; 4+2\alpha+\alpha^2 \; 4+\alpha^2]\right)$ \\
  $\implies$ poli so $-1, -\alpha+2i, -\alpha-2i$ \\
  $\alpha = 0.1 \dots$ \\
  $\alpha = 0.01 \dots$
\end{exmp}


\section{Routh-Hurtwizov kriterij}

Če je $g(s)$ racionalna funkcija,
je stabilnost odvisna od položaja polov oz. ničel imenovalca \refeq{eq:sistem}.
\begin{defn}
  Za polinom $p(x) = a_0 x^n + a_1 x^{n-1} + \dots + a_n, a_0 \neq 0, a_i \in \R$ pravimo,
  da je stabilen, če vse njegove ničle ležijo strogo v levi kompleksni podravnini
  $\{z \in \C: Re(z) < 0\}$.
\end{defn}
\begin{lemma}
  Če je polinom \refeq{eq:sistem} stabilen,
  potem so vsi koeficienti neničelni in istega predznaka.
\end{lemma}
\begin{pro} \text{} \\
  $p(x) = a_0 (x-\xi_1) \dots (x-\xi_k)$, kjer so $\xi_1 \dots \xi_k$ ničle. \\
  Lahko predpostavimo, da je $a_0 > 0$.
  \begin{enumerate}[label=\alph*)]
      \item $\xi_i \in \R \implies \xi_i = -b_i$ za neki $b_i > 0 \implies \xi_i$
          \sn{pripada} faktor $(x+b_i)$.
      \item $\xi_i \notin \R \implies \xi_{i,i+1} = -c_i \pm i d_i$ za neki
          $c_i > 0, d_i \neq 0$ \\
          $\implies$ \sn{pripada} $(x+c_i-id_i) (x+c_i+id_i) = (x^2 + 2c_ix + c_i^2+d_i^2)$ \\
          $\implies$ $p(x)$ je produkt linearnih in kvadratnih faktorjev
          s pozitivnimi realnimi koeficienti \\
          $\implies$ vsi koeficienti $p$ so neničelni in istega predznaka.
  \end{enumerate}
\end{pro}
To je potreben, ne pa tudi zadosten pogoj, npr. \\
$p(x) = x^3 + x^2 + 2x + 8 = (x+2) (x^2-x+4)$; \\
$x^2-x+4$ ne ustreza pogoju $\implies p$ ni stabilen. \\
Za polinom \refeq{eq:sistem} definiramo Routhovo tabelo
\begin{center}
  \begin{tabular}{c | c c c c c}
       & & & & & \\
      \hline
      0 & $a_0$ & $a_2$ & $a_4$ & $a_6$ & $\dots$ \\
      1 & $a_1$ & $a_3$ & $a_5$ & $a_7$ & $\dots$ \\
      2 & $\gamma_{21}$ & $\gamma_{22}$ & $\gamma_{23}$ & $\dots$ & \\
      3 & $\gamma_{31}$ & $\gamma_{32}$ & $\dots$ & & \\
      $\vdots$ & & & & & \\
      $n$ & $\gamma_n$
  \end{tabular}
\end{center}
Za $k \geq 2: r_{k,j} = r_{k-2,j+1} - \frac{r_{k-2,1}}{r_{k-1,1}} \cdot r_{k-1,j+1}$.
% skica
\begin{exmp} \text{} \\
  $p(x) = x^5 + 2x^4 + 6x^3 + 6x^2 + 4x + 2$
  \begin{center}
      \begin{tabular}{c | c c c c}
          & & & & \\
          \hline
          0 & 1 & 6 & 4 & \\
          1 & 2 & 6 & 2 & \\
          2 & 3 & 3 & & $[6 \; 4] - \frac{1}{2} [6 \; 2] = [3 \; 3]$ \\
          3 & 4 & 2 & & $[6 \; 2] - \frac{2}{3} [3 \; 0] = [4 \; 2]$ \\
          4 & $\frac{3}{2}$ & & & $3 - \frac{1}{4} \cdot 2 = \frac{3}{2}$ \\
          5 & 2 & & & $2 - \frac{3}{2} \cdot 0$
      \end{tabular}
  \end{center}
\end{exmp}
\begin{theorem}[Routh-Horwitz]
  Polinom \refeq{eq:sistem} je stabilen $\iff$
  vsi elementi v 1. stolpcu Routhove tabele so neničelni in istega predznaka.
\end{theorem}



% 4. predavanje 12.3.

Routh-Hurwitzov kriterij
\begin{equation}
    \label{eq:RH-poly}
    p(x) = a_0 x^n + a_1 x^{n-1} + \dots + a_n; \; a_0 \neq 0, a_i \in \R
\end{equation}
Polinom je stabilen, če vse njegove ničle ležijo v $\{z \in \C: Re(z) \neq 0\}$ \\
$\implies$ vsi koeficienti so neničelni in istega predznaka. \\
Routhova tabela
\begin{center}
    \begin{tabular}{c | c c c c}
        & & & & \\
        \hline
        0 & $a_{0}$ & $a_{2}$ & $a_{4}$ & $a_{6}$ \\
        1 & $a_{1}$ & $a_{3}$ & $a_{5}$ & $a_{7}$ \\
        2 & $r_{21}$ & $r_{22}$ & $r_{23}$ & \\
        3 & $r_{31}$ & $r_{32}$ & & \\
        \vdots & & & & \\
        $n$ & $r_{n1}$
    \end{tabular}
\end{center}
% skica
$r_{k,j} = r_{k-2,j+1} - \frac{r_{k-2,1}}{r_{k-1,1}} \cdot r_{k-1,j+1}$.
\begin{theorem}
    Polinom \refeq{eq:RH-poly} je stabilen $\iff$ vsi elementi v 1. stoplcu
    Routhove tabele so neničelni in istega predznaka.
\end{theorem}
\begin{lemma}
    Polinom \refeq{eq:RH-poly} je stabilen $\iff a_0 a_1 > 0$ in je polinom \\
    $q(x) = p(x) - \frac{a_0}{a_1} \left(a_1 x^n + a_3 x^{n-2} + a_5 x^{n-4} + \dots \right)$
    stabilen.
\end{lemma}
\begin{pro} izreka (ob predpostavkah, da lema velja). \\
    Uporabimo indukcijo: \\
    $n=1$:
    \begin{align*}
        a_0 + a_1 x = 0 \implies x = -\frac{a_1}{a_0} < 0 \text{ za } a_0 a_1 > 0.
    \end{align*}
    $n-1 \to n$: \\
    ključna je ugotovitev, da spodnjih $n$ vrstic Routhove tabele ustreza
    Routhovi tabeli za polinom $q$ stopnje $n-1$ iz leme. \\
    Res: 
    \begin{align*}
        q(x) &= a_1 x^{n-1} + a_3 x^{n-3} \\
        &+ \left(a_2 - \frac{a_0}{a_1} a_3 \right) x^{n-2} + \left(a_4 - \frac{a_0}{a_1} a_5 \right) x^{n-4} + \dots
    \end{align*} 
    1. del: 1. vrstica, \\
    2. del: $[a_2 \; a_4 \dots] - \frac{a_0}{a_1} [a_3 \; a_5 \dots] \to$ formula. \\
    $p$ je stabilen \\
    $\iff a_0 a_1 > 0$ in vsi elementi iz 1. stolpca Routhove tabele za $f$ so neničelni
    in istega predznaka \\
    $\iff a_0 a_1 > 0$ in elementi od 1. do zadnjega iz Routhove tabele so neničelni
    in istega predznaka \\
    $\iff$ vsi elementi 1. stolpca Routhove tabele so neničelni in istega predznaka.
\end{pro}
\begin{pro} leme. \\
    Predpostavimo lahko $a_1 \neq 0$ (vsi koeficienti so $> 0$ ali $< 0$). \\
    Razdelimo: $p(x) = p_{sod}(x) + p_{lih}(x)$ - sode, lihe potence. \\
    Definiramo
    \begin{align*}
    h_{\lambda}(x) &= p(x) - \lambda \frac{a_0}{a_1} \left(a_1 x^n + a_2 x^{n-2} + \dots \right) \\
    &= \begin{cases}
        p(x) - \lambda \frac{a_0}{a_1} x \cdot p_{lih}(x); \; n \text{ sod} \\
        p(x) - \lambda \frac{a_0}{a_1} x \cdot p_{sod}(x); \; n \text{ lih}
    \end{cases}
    \end{align*}
    $h_{\lambda}(x)$ je polinom stopnje $n$ za vsak $\lambda \neq 1$, pri $\lambda = 1$
    dobimo $h_{\lambda}(x) = q(x)$, pri $\lambda = 0$ pa $h_{\lambda}(x) = p(x)$. \\
    % skica
    Pokažemo lahko, da ima $h_{\lambda}$ vedno isto število ničel na imaginarni osi,
    neodvisno od $\lambda$. \\
    Denimo, da je $n$ sod (za lih primer je dokaz podoben). \\
    $h_{\lambda}(x) = p_{sod}(x) - \lambda \frac{a_0}{a_1} p_{lih}(x) + p_{lih}(x)$; \\
    $p_{sod}(x) - \lambda \frac{a_0}{a_1} p_{lih}(x)$: sod polinom, \\
    $p_{lih}(x)$: lih polinom.
    Naj bo $h_{\lambda}(i \alpha) = 0$ za $\alpha \in \R, \alpha \neq 0$ za nek $\lambda$. \\
    Vemo: $g_{\lambda}(x) \in \R$ (sod) \text{ in } $p_{lih}(i \alpha) \in i \R$ \\
    $\implies$ iz $h_s(i \alpha) = 0$ sledi $p_{lih}(i \alpha) = 0 in g_{\lambda}(i \alpha) = 0$ \\
    $\implies p_{sod}(i \alpha) = 0$ \\
    $\implies \text{ za } \forall \lambda \text{ je } h_{\lambda}(i \alpha) = 0$. \\
    (Podobno: če je $\alpha$ $k$-kratna ničla $h_{\lambda}$ za nek $\lambda$
    $\implies$ $k$-kratna ničla za vsak $\lambda$.) \\
    Ostane še $h_{\lambda}(0) = 0$ \\
    $\implies p(0) = 0$ in spet $h_{\lambda}(0) = 0$ za vsak $\lambda$.
\end{pro}
Pogledamo situacijo pri $\lambda = 1-\varepsilon$, ko gre $\varepsilon \to 0$. \\
$h_{1-\varepsilon}(x) = \varepsilon a_{0}x^n + a_1 x^{n-1} + \dots$ \\
$\implies$ $h_{1-\varepsilon}(x)$ ima ničlo $\chi \approx - \frac{a_1}{\varepsilon a_0} \to \infty$
ko gre $\varepsilon \to 0$. \\
$x^n h_{1-\varepsilon}\left(\frac{1}{x}\right) = rev(h_{1-\varepsilon})(x)
= a_n x^n + \dots + a_1 x + \varepsilon a_0$. \\
Ko gre $\varepsilon \to 0$, gre ena ničla proti 0, v bližini pa je $\approx -\frac{\varepsilon a_0}{a_1}$. \\
% skica
Iz $-\infty$, ker $a_0 a_1 > 0$, $q$ stabilen: vsi levo, se ne premakne desno $\implies$ vse ničle $p$ levo. \\
Ničla \sn{se pojavi}. \\
--- \\
$p_1(x_1, x_2 \dots x_n) = 0$ \\
$p_n(x_1, x_2 \dots x_n) = 0$. \\
Metode zveznega nadaljevanja - homostopske metode.
$q_1(x_1, x_2 \dots x_n) = 0$ \\
$q_n(x_1, x_2 \dots x_n) = 0$. \\
$H(\lambda, x) = (1-\lambda) Q(x) + \lambda P(x)$ \\
$H(0, x) = Q(x)$ \\
$H(1, x) = P(x)$. \\
% skica
Rešimo npr. z Newtonovo metodo.
% skica
\begin{exmp} \text{} \\
    $g(s) = s^3 + 4s^2 + ks + 8$. \\
    Za kakšne vrednosti $k$ je sistem stabilen?
    \begin{center}
        \begin{tabular}{c | c c}
            & & \\
            \hline
            0 & 1 & $k$ \\
            1 & 4 & 8 \\
            2 & $k-2$ & \\
            3 & 8
        \end{tabular}
    \end{center}
    $\implies \; g$ bo stabilen $\iff \; k > 2$.
\end{exmp}


\section{Napaka ustaljenega stanja}

Imamo sistem z referenčnim vhodom in povratno zanko. \\
% skica
$r(t)$: referenčni vhod (želena vrednost), npr. hitrost, temperatura, \\
$y(t)$: izhod (dejanska vrednost), \\
$e(t) = r(t) - y(t)$: razlika, odstopanje \\
$Y(s) = G(s) E(s) = G(s) (R(s) - Y(s)) \implies Y(s) = \frac{G(s)}{1+G(s)} R(s)$ \\
$E(s) = R(s) - Y(s) = \frac{1}{1+Y(s)} R(s)$. \\
Napaka ustaljenega stanja (steady-state error) je limita $e(t)$, ko gre \\
$t \to \infty$.
\begin{equation*}
    e_{ss} := \lim_{t \to \infty} e(t) = \lim_{s \to 0} s E(s) =
    \lim_{s \to 0} \frac{s R(s)}{1+Y(s)};
\end{equation*}
2. enakost velja zaradi izreka o končni vrednosti, če limita obstaja. \\
Za večino sistemov zadošča, da poznamo napako ustaljenega stanja za
\begin{enumerate}[label=\alph*)]
    \item enotsko stopnico $r(t) = u_s(t), R(s) = \frac{1}{s} \implies e_{ss1}$
    \item enotsko rampo (unit ramp) $r(t) = t u_s(t), R(s) = \frac{1}{s^2} \implies e_{ss2}$
    \item enotsko parabolo $r(t) = \frac{1}{2} t^2 u_s(t), R(s) = \frac{1}{s^3} \implies e_{ss3}$.
\end{enumerate}
% skica
Pravimo, da je sistem tipa $r$, če ima $G(s)$ pol stopnje $r$ pri $s=0$
(po krajšanju števca in imenovalca).
Večina sistemov je tipa 0,1,2.
Tip operacij, da $G(s)$ nima pola pri $s = 0$.
\begin{enumerate}[label=\alph*)]
    \item Enotska stopnica, $R(s) = \frac{1}{s}$ \\
        $e_{ss0} = \lim_{s \to 0} \frac{s \frac{1}{s}}{1+G(s)} =
        \lim_{s \to 0} \frac{1}{1+G(s)} = \frac{1}{1+K_p}$ \\
        $K_p := \lim_{s \to 0} G(s)$: konstanta napake položaja. \\
        Če je sistem tipa 0 $\implies$ $K_p$ je končen, $\implies e_{ss0} = \frac{1}{1+K_p}$, \\
        če je sistem tipa $\geq 1 \; \implies$ $K_p = \infty$, $\implies e_{ss0} = 0$. \\
        Tip pomeni število idealnih integratorjev, ki jih vsebuje sistem (šibka vezava).
        % skica
    \item Enotska rampa, $R(s) = \frac{1}{s^2}$ \\
        $e_{ss1} = \lim_{s \to 0} \frac{s \frac{1}{s^2}}{1+G(s)} =
        \lim_{s \to 0} \frac{1}{s+sG(s)} = \frac{1}{K_v}$ \\
        $K_v := \lim_{s \to 0} s G(s)$: konstanta napake hitrosti. \\
        Če je sistem tipa 0 $\implies \; K_v = 0$, $\implies e_{ss1} = \infty$, \\
        če je sistem tipa 1 $\implies \; K_v$ končen, $\implies e_{ss1} = \frac{1}{K_v}$, \\
        če je sistem tipa $\geq 2 \; \implies \; K_v = \infty$, $\implies e_{ss1} = 0$, \\
    \item Enotska parabola, $R(s) = \frac{1}{s^3}$ \\
        $e_{ss2} = \lim_{s \to 0} \frac{s \frac{1}{s^3}}{1+G(s)} =
        \lim_{s \to 0} \frac{1}{s^2+s^2 G(s)} = \frac{1}{K_a}$ \\
        $K_a := \lim_{s \to 0} s^2 G(s)$: konstanta napake pospeška. \\
        Če je sistem tipa $\leq 1 \; \implies \; K_a = 0$, $\implies e_{ss2} = \infty$, \\
        če je sistem tipa 2 $\implies \; K_v$ končna, $\implies e_{ss2} = \frac{1}{K_a}$.
\end{enumerate}
\begin{center}
    \begin{tabular}{c | c c c |c c c}
        tip & $K_p$ & $K_v$ & $K_a$ & $e_{ss0}$ & $e_{ss1}$ & $e_{ss2}$ \\
        \hline
        0 & $K_p$ & 0 & 0 & $\frac{1}{1+K_p}$ & $\infty$ & $\infty$ \\
        1 & $\infty$ & $K_v$ & 0 & 0 & $\frac{1}{K_v}$ & $\infty$ \\
        2 & $\infty$ & $\infty$ & $K_a$ & 0 & 0 & $\frac{1}{K_a}$ \\
    \end{tabular}
\end{center}
% skica
MO: maksimalni prevzpon (maximal overshoot) - najjvečje odstopanje v prehodni fazi, \\
ST: čas izravnave (setting time) - od kod naprej je napaka < 5\% (< 2\%), \\
RT: čas vzpona (rise time): od 10\% do 90\%, \\
DT: čas zakasnitve (delay time): od 0\% do 50\%.


\section{PID regulator}

% skica
$e(t) = y(t) - r(t)$. \\
Regulator na podlagi napake (odstopanja) $e(t)$ pripravi vhod $u(t)$ na sistem
s ciljem da gre $e(t) \stackrel{t \to \infty}{\longrightarrow} 0$. \\
Prva ideja: dvopoložajno vodenje (on-off control)
\begin{equation*}
    u(t) \begin{cases}
        u_{max}: \; e(t) \geq 0 \\
        u_{min}: \; e(t) < 0
    \end{cases}
\end{equation*}
Težave:
\begin{itemize}
    \item oscilacije,
    \item pogosto vklapljanje in izklapljanje.
\end{itemize}
Izboljšava: vpeljemo mrtvo cono (dead zone)
\begin{equation*}
    u(t) \begin{cases}
        u_{max}: \; &e(t) > \varepsilon \\
        u_{min}: \; &e(t) < -\varepsilon \\
        0 &\text{sicer}.
    \end{cases}
\end{equation*}
Proporcionalno vodenje:
\begin{equation*}
    u(t) = K_p \cdot e(t).
\end{equation*}
$K_p$: koeficient proporcionalnega vodenja (proportional gain). \\
Težava: $e_{ss0} = \frac{1}{1+K_p}$. \\
Integrirano vodenje:
\begin{align*}
    &u(t) K_i \cdot \int_0^t e(\tau) d\tau, \\
    &C(s) = \frac{K_i}{s}.
\end{align*}
% skica
PI (proporcionalno-integrirno vodenje): \\
$C(s) = K_p + \frac{K_i}{s}$. \\
Diferencirno vodenje \\
\begin{equation*}
    u(t) = K_d \cdot e(t).
\end{equation*}
PID (proporcionalno-integrirno-diferencirno vodenje): \\
$C(s) = K_p + \frac{K_i}{s} + K_d s =
\frac{1}{s} \left( K_i + K_p s + K_d s^2\right)$. \\
% skica
PID regulator, \\
$G(s)$: sistem.



%\clearpage
%\phantomsection

%\addcontentsline{toc}{chapter}{Literatura}
%\bibliography{../bibtex/literatura}
%\bibliographystyle{plainnat}


%\clearpage
%\phantomsection

%\chapter*{Dodatki}
%\addcontentsline{toc}{chapter}{Dodatki}
%D.




\end{document}
